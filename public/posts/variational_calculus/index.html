<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>My calculus of variations crash course | iamtu</title>
<meta name=keywords content="learn,fdm,ml,pde,pinn"><meta name=description content="My goal for this post is to have a basic understanding of Calculus of Variations, so that I can be more comfortable with mathematics in NeuralODE paper, where the problem can be formulated as a optimization of a functional with ODE constraint (Adjoint State Method for an ODE).
My first encounter with Calculus of Variation is one of my homework where we try to derive probablity density function of some distribution by the principle of maximum entropy."><meta name=author content="Tu T. Do"><link rel=canonical href=http://localhost:1313/posts/variational_calculus/><meta name=google-site-verification content="G-PWLR4FLELZ"><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/variational_calculus/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous onload=renderMathInElement(document.body)></script><script async src="https://www.googletagmanager.com/gtag/js?id=G-PWLR4FLELZ"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-PWLR4FLELZ")}</script><meta property="og:title" content="My calculus of variations crash course"><meta property="og:description" content="My goal for this post is to have a basic understanding of Calculus of Variations, so that I can be more comfortable with mathematics in NeuralODE paper, where the problem can be formulated as a optimization of a functional with ODE constraint (Adjoint State Method for an ODE).
My first encounter with Calculus of Variation is one of my homework where we try to derive probablity density function of some distribution by the principle of maximum entropy."><meta property="og:type" content="article"><meta property="og:url" content="http://localhost:1313/posts/variational_calculus/"><meta property="og:image" content="http://localhost:1313/images/cal_fig1.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-09-24T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-24T00:00:00+00:00"><meta property="og:site_name" content="iamtu"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/cal_fig1.png"><meta name=twitter:title content="My calculus of variations crash course"><meta name=twitter:description content="My goal for this post is to have a basic understanding of Calculus of Variations, so that I can be more comfortable with mathematics in NeuralODE paper, where the problem can be formulated as a optimization of a functional with ODE constraint (Adjoint State Method for an ODE).
My first encounter with Calculus of Variation is one of my homework where we try to derive probablity density function of some distribution by the principle of maximum entropy."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"My calculus of variations crash course","item":"http://localhost:1313/posts/variational_calculus/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"My calculus of variations crash course","name":"My calculus of variations crash course","description":"My goal for this post is to have a basic understanding of Calculus of Variations, so that I can be more comfortable with mathematics in NeuralODE paper, where the problem can be formulated as a optimization of a functional with ODE constraint (Adjoint State Method for an ODE).\nMy first encounter with Calculus of Variation is one of my homework where we try to derive probablity density function of some distribution by the principle of maximum entropy.","keywords":["learn","fdm","ml","pde","pinn"],"articleBody":" My goal for this post is to have a basic understanding of Calculus of Variations, so that I can be more comfortable with mathematics in NeuralODE paper, where the problem can be formulated as a optimization of a functional with ODE constraint (Adjoint State Method for an ODE).\nMy first encounter with Calculus of Variation is one of my homework where we try to derive probablity density function of some distribution by the principle of maximum entropy. This is my note of a more thorough investigation of the topic and it is heavily based on the content of this tutorial.\nSimilar to differential calculus where we try to find a stationary point, calculus of variations find a function to either minimize or maximize a functional (which is a function that take another function as argument).\nMotivating examples Shortest path between two points A path \\(y(x)\\) that passes two points \\(P_A(a, A), P_B(b, B)\\), so that \\(y(a)=A\\) and \\(y(b)=B\\).\nConsider an infinitestimal segment along the path \\(y\\), the length of this curve is given by:\n$$ \\begin{equation} dS = \\sqrt{dx^2 + dy^2} = \\sqrt{1 + (\\dot{y})^2} dx \\end{equation} $$\nThen the length of curve \\(y\\) is given by the sum of all \\(dS\\) along \\(y\\):\n$$ \\begin{equation} S[y] = \\int_{P_A}^{P_B}{dS} = \\int_a^b{\\sqrt{1 + (\\dot{y})^2}dx} \\end{equation} $$\n\\(S\\) is called a length functional of \\(y\\). The goal is to find function \\(y\\) to minimize \\(S\\).\nBrachistochrone curve A more exciting example would be the Brachistochrone problem, which was posed by Johann Bernoulli in 1696:\nGiven two points A and B in a vertical plane, what is the curve traced out by a point acted on only by gravity, which starts at A and reaches B in the shortest time.\nThe apparatus can be depicted in following diagram. In order to simplify the problem, we let two points \\(A, B\\) at \\(A(0, 0)\\) and \\(B(b, 1)\\) respectively.\nThe total energy of this system can be described as\n$$ \\begin{equation} E = \\frac{1}{2}mv^2 - mgy \\end{equation} $$\nWhere \\(m, v\\) is the mass and velocity of the point respectively. At \\(t = 0\\), both \\(v, y\\) are \\(0\\), so that the total engery of the system is 0. Due to the law of conservation of enery:\n$$ \\begin{equation} \\begin{aligned} \u0026 E = \\frac{1}{2}mv^2 - mgy = 0 \\\\ \\implies \u0026 v = \\sqrt{2gy} \\end{aligned} \\end{equation} $$\nLet \\(S\\) be the length of the curved traced out by the point, by definition of velocity we have\n$$ \\begin{equation} v = \\frac{dS}{dt} = \\sqrt{2gy} \\end{equation} $$\nFor an infinitestimal segment of the curve \\(y\\), we have\n$$ \\begin{equation} dS = \\sqrt{dx^2 + dy^2} = \\sqrt{1 + (\\dot{y})^2}dx \\end{equation} $$\nSubstituing eq (7) into eq (6), we have:\n$$ \\begin{equation} \\begin{aligned} \u0026 v = \\frac{\\sqrt{1+(\\dot{y})^2}dx}{dt} = \\sqrt{2gy} \\\\ \\implies \u0026 dt =\\sqrt{\\frac{1+(\\dot{y})^2}{2gy}}dx \\\\ \\implies \u0026 T[y] = \\int_0^b{\\sqrt{\\frac{1+(\\dot{y})^2}{2gy}}dx} \\end{aligned} \\end{equation} $$\n\\(T\\) is the time functional of function \\(y\\), the goal is to find y such that \\(T\\) is minimized.\nEuler-Lagrange equation Let \\(S\\) be a functional of some function \\(y(x)\\) that go through two points \\(P_a(a, A)\\) and \\(P_b(b, B)\\), defined by\n$$ \\begin{equation} \\begin{aligned} S[y] = \\int_a^b {F(x, y, \\dot{y}) dx} \\quad y(a)=A, y(b) = B \\end{aligned} \\end{equation} $$\nWhere is \\(F\\) is some function of \\(x, y\\), and \\(\\dot{y}\\). The Euler-Lagrange equation states that in order for \\(y\\) to be a stationary path of the functional \\(S\\), the following equality must hold:\n$$ \\begin{equation} \\frac{\\partial F}{\\partial y} - \\frac{d}{dx}\\bigg(\\frac{\\partial F}{\\partial \\dot{y}}\\bigg) = 0 \\end{equation} $$\nDerivation of Euler-Lagrange equation Let \\(\\tilde{y}(x) = y + \\epsilon \\eta(x)\\), such that \\(\\eta(a) = \\eta(b) = 0 \\) be some function that passes through \\(P_a, P_b\\). For \\(y\\) to be a stationary path of \\(S\\):\n$$ \\begin{equation} \\begin{aligned} \u0026 \\frac{d}{d\\epsilon}S[\\tilde{y}] \\bigg\\vert_{\\epsilon=0} = 0 \\\\ \\iff \u0026 \\frac{d}{d\\epsilon}\\int_a^b{F(x, \\tilde{y}, \\dot{\\tilde{y}}) dx} = 0 \\\\ \\iff \u0026 \\int_a^b{ \\frac{d}{d\\epsilon}F(x, \\tilde{y}, \\dot{\\tilde{y}}) \\big\\vert_{\\epsilon=0} dx } = 0 \\\\ \\iff \u0026 \\int_a^b{ \\big[ \\underbrace{ \\frac{\\partial F}{\\partial x} \\frac{dx}{d\\epsilon} }_{=0} + \\frac{\\partial F}{\\partial \\tilde{y}} \\frac{d\\tilde{y}}{d\\epsilon} + \\frac{\\partial F}{\\partial \\dot{\\tilde{y}}} \\frac{d\\dot{\\tilde{y}}}{d\\epsilon} \\big] \\bigg\\vert_{\\epsilon=0} dx} = 0 \\\\ \\iff \u0026 \\int_a^b{\\bigg[ \\frac{\\partial F}{\\partial \\tilde{y}} \\eta + \\frac{\\partial F}{\\partial \\dot{\\tilde{y}}} \\dot{\\eta} \\bigg]\\bigg\\vert_{\\epsilon=0}dx} = 0 \\end{aligned} \\end{equation} $$\nWhen \\(\\epsilon\\rightarrow 0 : \\tilde{y} \\rightarrow y \\), subsitute into equation 3:\n$$ \\begin{equation} \\begin{aligned} \u0026 \\int_a^b{\\bigg( \\frac{\\partial F}{\\partial y} \\eta + \\frac{\\partial F}{\\partial \\dot{y}} \\dot{\\eta} \\bigg)dx} = 0 \\\\ \\iff \u0026 \\int_a^b{\\frac{\\partial F}{\\partial y} \\eta dx} + \\underbrace{\\bigg[\\frac{\\partial F}{\\partial\\dot{y}}\\eta\\bigg]_a^b}_{=0} - \\int_a^b{\\frac{d}{dx}\\big(\\frac{\\partial F}{\\partial\\dot{y}}\\big) dx} = 0 \u0026 \\quad \\text{(Integration by part)} \\\\ \\iff \u0026 \\int_a^b{\\bigg( \\frac{\\partial F}{\\partial y} - \\frac{d}{dx} \\big(\\frac{\\partial F}{\\partial \\dot{y}}\\big) \\bigg)\\eta dx} = 0 \\end{aligned} \\end{equation} $$\nBecause \\(\\eta\\) is arbitrary, in order for equality (4) to hold, quantity \\( \\frac{\\partial F}{\\partial y} - \\frac{d}{dx}\\big(\\frac{\\partial F}{\\partial \\dot{}y}\\big) \\) has to be equal to \\(0\\).\n\\begin{equation} \\blue{ \\frac{\\partial F}{\\partial y} - \\frac{d}{dx}\\big(\\frac{\\partial F}{\\partial \\dot{y}}\\big) = 0 } \\end{equation}\nThis equation is known as Euler-Lagrange equation. Any function \\(y\\) satisfied this equation will be a stationary path of functional \\(S\\).\nAlternative forms of the Euler-Lagrange equation Special case where \\(F\\) does not explicitly depend on \\(y\\) \\(F(x, \\dot{y})\\) Because \\(F\\) does not explicity dependence on \\(y\\), we have \\(\\partial F/\\partial y =0\\). By equation 12, it immediately follows:\n$$ \\begin{equation} \\begin{aligned} \u0026 \\frac{d}{dx}(\\frac{\\partial F}{\\partial \\dot{y}}) = 0 \\\\ \\iff \u0026 \\frac{\\partial F}{\\partial \\dot{y}} = \\text{constant} \\end{aligned} \\end{equation} $$\nFirst integral of Euler-Lagrange equation \\(F(y, \\dot{y})\\) Consider the total derivative of \\(F\\) with respect to \\(x\\):\n$$ \\begin{equation} \\begin{aligned} \\frac{dF}{dx} \u0026 = \\underbrace{\\frac{\\partial F}{\\partial x}}_{=0} + \\frac{\\partial F}{\\partial y}\\frac{dy}{dx} + \\frac{\\partial F}{\\partial \\dot{y}}\\frac{d \\dot{y}}{dx} \u0026 (F \\text{ does not depend on }x) \\\\ \u0026 = \\frac{d}{dx}\\big(\\frac{\\partial F}{\\partial \\dot{y}}\\big)\\dot{y} + \\frac{\\partial F}{\\partial \\dot{y}}\\ddot{y} \u0026 \\text{(Equation 12)}\\\\ \u0026 = \\frac{d}{dx}\\big(\\dot{y}\\frac{\\partial F}{\\partial\\dot{y}}\\big) \u0026 u\\dot{v} + v\\dot{u} = \\dot{(uv)} \\\\ \\implies \u0026 \\dot{y}\\frac{\\partial F}{\\partial\\dot{y}} - F = \\text{constant} \\end{aligned} \\end{equation} $$\nThis equation is called the first integral of Euler-Lagrange equation.\nApplying Euler-Lagrange equation to the motivating examples Shortest path between two point on a plane Reiterate that the path length of curve \\(y(x)\\) is a functional \\(S\\) of \\(y\\):\n$$ \\begin{equation} \\begin{aligned} \u0026 S[y] = \\int_{P_A}^{P_B}{dS} = \\int_a^b{\\sqrt{1 + (\\dot{y})^2}dx} =: \\int_a^b{F(\\dot{y})dx};\\\\ \u0026 y(a)=A, y(b) = B \\end{aligned} \\end{equation} $$\nFrom equation 15, we have\n$$ \\begin{equation} \\begin{aligned} \u0026 \\frac{\\partial F}{\\partial \\dot{y}} = \\text{constant} \\\\ \\iff \u0026 \\frac{\\partial}{\\partial \\dot{y}}\\sqrt{1 + (\\dot{y})^2} = \\text{constant} \\\\ \\iff \u0026 \\frac{\\dot{y}}{\\sqrt{1 + (\\dot{y})^2}} = \\text{constant} \\\\ \\iff \u0026 \\dot{y} = \\text{constant} \\\\ \\implies \u0026 y = ax + b \\end{aligned} \\end{equation} $$\nSo the shortest path between two points on a plane is a line.\nBrachistochrone problem Time functional \\(T\\) of curve \\(y(x)\\):\n$$ \\begin{equation} \\begin{aligned} T[y] = \\int_0^b{\\sqrt{\\frac{1+(\\dot{y})^2}{2gy}}dx} =: \\int_0^b{F(y,\\dot{y}) dx} \\end{aligned} \\end{equation} $$\nUsing the first integral of the Euler-Lagrange equation, we have\n\\begin{equation} \\begin{aligned} \u0026 \\dot{y}\\frac{\\partial F}{\\partial \\dot{y}} - F = c \u0026 \\text{(c is some constant)} \\\\ \\iff \u0026 \\dot{y}\\frac{\\partial}{\\partial{\\dot{y}}}\\big( \\sqrt{\\frac{1 + (\\dot{y})^2}{2gy}} \\big) - \\sqrt{\\frac{1 + (\\dot{y})^2}{2gy}} = c \\\\ \\iff \u0026 \\frac{(\\dot{y})^2}{\\sqrt{2gy[1+(\\dot{y})^2]}} - \\sqrt{\\frac{1 + (\\dot{y})^2}{2gy}} = c \\\\ \\iff \u0026 \\frac{1}{\\sqrt{y[1+(\\dot{y})^2]}} = k \u0026 \\text{(for some constant k)} \\\\ \\implies \u0026 \\dot{y} = \\sqrt{\\frac{h^2}{y} - 1} = \\sqrt{\\frac{h^2 - y}{y}} \u0026 (\\text{for constant } h^2=1/k^2 \u003e 0) \\\\ \\implies \u0026 dx = \\sqrt{\\frac{y}{h^2 - y}}dy \\end{aligned} \\end{equation}\nLet \\(y = h^2 \\sin^2\\theta\\), so \\(dy = 2h^2\\sin\\theta\\cos\\theta d\\theta\\). Subsititutes this into equation 18, we have\n$$ \\begin{equation} \\begin{aligned} dx \u0026 = \\sqrt{\\frac{h^2 \\sin^2\\theta}{h^2(1 - \\sin^2\\theta)}}2h^2\\sin\\theta\\cos\\theta d\\theta \\\\ \u0026 = 2h^2 \\sin^2\\theta d\\theta \\end{aligned} \\end{equation} $$\nTake the antiderivative for both sides, we have\n$$ x = \\frac{h^2}{2}(2\\theta - \\sin 2\\theta) + c $$\nFinally, we have \\(x = \\frac{h^2}{2}(2\\theta - \\sin 2\\theta) + c\\) and \\(y = h^2\\sin^2\\theta\\), for some \\(h, c\\) determined by \\(y(0) = 0, y(b) = 1\\). In the tutorial, \\(h\\) and \\( c\\) can only be determined numerically.\nReferences Introduction to Calculus of Vartiations - Open University Adjoint State Method for an ODE Original NeuralODE paper ","wordCount":"1300","inLanguage":"en","image":"http://localhost:1313/images/cal_fig1.png","datePublished":"2024-09-24T00:00:00Z","dateModified":"2024-09-24T00:00:00Z","author":{"@type":"Person","name":"Tu T. Do"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/variational_calculus/"},"publisher":{"@type":"Organization","name":"iamtu","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="iamtu (Alt + H)">iamtu</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li></ul></div></div><ul id=menu><li><a href=http://localhost:1313/ title=home><span>home</span></a></li><li><a href=http://localhost:1313/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=http://localhost:1313/categories/ title=categories><span>categories</span></a></li><li><a href=http://localhost:1313/about/ title=about><span>about</span></a></li><li><a href=http://localhost:1313/archives/ title=archives><span>archives</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class=post-title>My calculus of variations crash course</h1><div class=post-meta><span title='2024-09-24 00:00:00 +0000 UTC'>September 24, 2024</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;1300 words&nbsp;·&nbsp;Tu T. Do</div></header><figure class=entry-cover><img loading=lazy src=http://localhost:1313/images/cal_fig1.png alt></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#motivating-examples aria-label="Motivating examples">Motivating examples</a><ul><li><a href=#shortest-path-between-two-points aria-label="Shortest path between two points">Shortest path between two points</a></li><li><a href=#brachistochrone-curve aria-label="Brachistochrone curve">Brachistochrone curve</a></li></ul></li><li><a href=#euler-lagrange-equation aria-label="Euler-Lagrange equation">Euler-Lagrange equation</a><ul><li><a href=#derivation-of-euler-lagrange-equation aria-label="Derivation of Euler-Lagrange equation">Derivation of Euler-Lagrange equation</a></li><li><a href=#alternative-forms-of-the-euler-lagrange-equation aria-label="Alternative forms of the Euler-Lagrange equation">Alternative forms of the Euler-Lagrange equation</a><ul><li><a href=#special-case-where-f-does-not-explicitly-depend-on-y-fx-doty aria-label="Special case where \(F\) does not explicitly depend on \(y\) \(F(x, \dot{y})\)">Special case where \(F\) does not explicitly depend on \(y\) \(F(x, \dot{y})\)</a></li><li><a href=#first-integral-of-euler-lagrange-equation-fy-doty aria-label="First integral of Euler-Lagrange equation \(F(y, \dot{y})\)">First integral of Euler-Lagrange equation \(F(y, \dot{y})\)</a></li></ul></li></ul></li><li><a href=#applying-euler-lagrange-equation-to-the-motivating-examples aria-label="Applying Euler-Lagrange equation to the motivating examples">Applying Euler-Lagrange equation to the motivating examples</a><ul><li><a href=#shortest-path-between-two-point-on-a-plane aria-label="Shortest path between two point on a plane">Shortest path between two point on a plane</a></li><li><a href=#brachistochrone-problem aria-label="Brachistochrone problem">Brachistochrone problem</a></li></ul></li><li><a href=#references aria-label=References>References</a></li></ul></div></details></div><div class=post-content><p>My goal for this post is to have a basic understanding of Calculus of Variations, so that I can be more comfortable with mathematics in <a href=https://arxiv.org/abs/1806.07366>NeuralODE paper</a>, where the problem can be formulated as a optimization of a functional with ODE constraint (<a href="https://www.youtube.com/watch?v=k6s2G5MZv-I&amp;t=556s">Adjoint State Method for an ODE</a>).</p><p>My first encounter with Calculus of Variation is one of my homework where we try to derive probablity density function of some distribution by the principle of maximum entropy. This is my note of a more thorough investigation of the topic and it is heavily based on the content of <a href="https://www.open.edu/openlearn/8b/91/8b919cebaa524d141308761405438be36126c07d?response-content-disposition=inline%3Bfilename%3D%22Introduction%20to%20the%20calculus%20of%20variations_ms327.pdf%22&amp;response-content-type=application%2Fpdf&amp;Expires=1727281020&amp;Signature=Y5qPgt8T-FL6MrViTgisHOaDvOZrnyRTlog5CKdcx3O3IaYDepGQ43r2ZdUf2rX3tGPulZYzYbf1H1RhB6Xv2V80TZtQThFlBZLMgHWWNDR3AZKxqL8FD3Xq2vlRwft~grD5fGpioT6G57~zDUKl0TQ7bR3PDv4DzUakrkhDg-NWehqo4dIk7v5PnyFEeki7qsvbz6Dtkqo9MwEn8Z-CDWg2IUwZ5ocNFSts7Hj8ABQpljFITa8C36XvZBgy8lcmPCAhAr4gFi26Y5PXnytW7~3FCqnlLJd6pA7yK-t9A5UMW7dooi6el4bvbuMVrbrZ~sLTNXeM9SXOryke07jTBw__&amp;Key-Pair-Id=K87HJKWMK329B">this tutorial</a>.</p><p>Similar to differential calculus where we try to find a stationary point, calculus of variations find a function to either minimize or maximize a functional (which is a function that take another function as argument).</p><h2 id=motivating-examples>Motivating examples<a hidden class=anchor aria-hidden=true href=#motivating-examples>#</a></h2><h3 id=shortest-path-between-two-points>Shortest path between two points<a hidden class=anchor aria-hidden=true href=#shortest-path-between-two-points>#</a></h3><p>A path \(y(x)\) that passes two points \(P_A(a, A), P_B(b, B)\), so that \(y(a)=A\) and \(y(b)=B\).</p><p><img loading=lazy src=/images/cal_fig1.png alt=Path></p><p>Consider an infinitestimal segment along the path \(y\), the length of this curve is given by:</p><p>$$
\begin{equation}
dS = \sqrt{dx^2 + dy^2} = \sqrt{1 + (\dot{y})^2} dx
\end{equation}
$$</p><p>Then the length of curve \(y\) is given by the sum of all \(dS\) along \(y\):</p><p>$$
\begin{equation}
S[y] = \int_{P_A}^{P_B}{dS} = \int_a^b{\sqrt{1 + (\dot{y})^2}dx}
\end{equation}
$$</p><p>\(S\) is called a length functional of \(y\). The goal is to find function \(y\) to minimize \(S\).</p><h3 id=brachistochrone-curve>Brachistochrone curve<a hidden class=anchor aria-hidden=true href=#brachistochrone-curve>#</a></h3><p>A more exciting example would be the Brachistochrone problem, which was posed by Johann Bernoulli in 1696:</p><blockquote><p>Given two points A and B in a vertical plane, what is the curve traced out by a point acted on only by gravity, which starts at A and reaches B in the shortest time.</p></blockquote><p>The apparatus can be depicted in following diagram. In order to simplify the problem, we let two points \(A, B\) at \(A(0, 0)\) and \(B(b, 1)\) respectively.</p><p><img loading=lazy src=/images/cal_fig2.png alt=brachritochrone></p><p>The total energy of this system can be described as</p><p>$$
\begin{equation}
E = \frac{1}{2}mv^2 - mgy
\end{equation}
$$</p><p>Where \(m, v\) is the mass and velocity of the point respectively. At \(t = 0\), both \(v, y\) are \(0\), so that the total engery of the system is 0. Due to the law of conservation of enery:</p><p>$$
\begin{equation}
\begin{aligned}
& E = \frac{1}{2}mv^2 - mgy = 0 \\
\implies &
v = \sqrt{2gy}
\end{aligned}
\end{equation}
$$</p><p>Let \(S\) be the length of the curved traced out by the point, by definition of velocity we have</p><p>$$
\begin{equation}
v = \frac{dS}{dt} = \sqrt{2gy}
\end{equation}
$$</p><p>For an infinitestimal segment of the curve \(y\), we have</p><p>$$
\begin{equation}
dS = \sqrt{dx^2 + dy^2} = \sqrt{1 + (\dot{y})^2}dx
\end{equation}
$$</p><p>Substituing eq (7) into eq (6), we have:</p><p>$$
\begin{equation}
\begin{aligned}
& v = \frac{\sqrt{1+(\dot{y})^2}dx}{dt} = \sqrt{2gy} \\
\implies &
dt =\sqrt{\frac{1+(\dot{y})^2}{2gy}}dx \\
\implies &
T[y] = \int_0^b{\sqrt{\frac{1+(\dot{y})^2}{2gy}}dx}
\end{aligned}
\end{equation}
$$</p><p>\(T\) is the time functional of function \(y\), the goal is to find y such that \(T\) is minimized.</p><h2 id=euler-lagrange-equation>Euler-Lagrange equation<a hidden class=anchor aria-hidden=true href=#euler-lagrange-equation>#</a></h2><p>Let \(S\) be a functional of some function \(y(x)\) that go through two points \(P_a(a, A)\) and \(P_b(b, B)\), defined by</p><p>$$
\begin{equation}
\begin{aligned}
S[y] = \int_a^b {F(x, y, \dot{y}) dx} \quad
y(a)=A, y(b) = B
\end{aligned}
\end{equation}
$$</p><p>Where is \(F\) is some function of \(x, y\), and \(\dot{y}\). The Euler-Lagrange equation states that in order for \(y\) to be a stationary path of the functional \(S\), the following equality must hold:</p><p>$$
\begin{equation}
\frac{\partial F}{\partial y} - \frac{d}{dx}\bigg(\frac{\partial F}{\partial \dot{y}}\bigg) = 0
\end{equation}
$$</p><h3 id=derivation-of-euler-lagrange-equation>Derivation of Euler-Lagrange equation<a hidden class=anchor aria-hidden=true href=#derivation-of-euler-lagrange-equation>#</a></h3><p>Let \(\tilde{y}(x) = y + \epsilon \eta(x)\), such that \(\eta(a) = \eta(b) = 0 \) be some function that passes through \(P_a, P_b\). For \(y\) to be a stationary path of \(S\):</p><p>$$
\begin{equation}
\begin{aligned}
& \frac{d}{d\epsilon}S[\tilde{y}] \bigg\vert_{\epsilon=0} = 0 \\
\iff & \frac{d}{d\epsilon}\int_a^b{F(x, \tilde{y}, \dot{\tilde{y}}) dx} = 0 \\
\iff & \int_a^b{
\frac{d}{d\epsilon}F(x, \tilde{y}, \dot{\tilde{y}}) \big\vert_{\epsilon=0} dx
} = 0 \\
\iff & \int_a^b{ \big[
\underbrace{
\frac{\partial F}{\partial x} \frac{dx}{d\epsilon}
}_{=0}
+ \frac{\partial F}{\partial \tilde{y}} \frac{d\tilde{y}}{d\epsilon}
+ \frac{\partial F}{\partial \dot{\tilde{y}}} \frac{d\dot{\tilde{y}}}{d\epsilon}
\big] \bigg\vert_{\epsilon=0}
dx} = 0 \\
\iff &
\int_a^b{\bigg[
\frac{\partial F}{\partial \tilde{y}} \eta
+ \frac{\partial F}{\partial \dot{\tilde{y}}} \dot{\eta}
\bigg]\bigg\vert_{\epsilon=0}dx} = 0
\end{aligned}
\end{equation}
$$</p><p>When \(\epsilon\rightarrow 0 : \tilde{y} \rightarrow y \), subsitute into equation 3:</p><p>$$
\begin{equation}
\begin{aligned}
& \int_a^b{\bigg(
\frac{\partial F}{\partial y} \eta
+ \frac{\partial F}{\partial \dot{y}} \dot{\eta}
\bigg)dx} = 0 \\
\iff &
\int_a^b{\frac{\partial F}{\partial y} \eta dx}
+ \underbrace{\bigg[\frac{\partial F}{\partial\dot{y}}\eta\bigg]_a^b}_{=0}
- \int_a^b{\frac{d}{dx}\big(\frac{\partial F}{\partial\dot{y}}\big) dx} = 0 & \quad \text{(Integration by part)} \\
\iff &
\int_a^b{\bigg(
\frac{\partial F}{\partial y} - \frac{d}{dx} \big(\frac{\partial F}{\partial \dot{y}}\big)
\bigg)\eta dx} = 0
\end{aligned}
\end{equation}
$$</p><p>Because \(\eta\) is arbitrary, in order for equality (4) to hold, quantity \( \frac{\partial F}{\partial y} - \frac{d}{dx}\big(\frac{\partial F}{\partial \dot{}y}\big) \) has to be equal to \(0\).</p><p>\begin{equation}
\blue{
\frac{\partial F}{\partial y} - \frac{d}{dx}\big(\frac{\partial F}{\partial \dot{y}}\big) = 0
}
\end{equation}</p><p>This equation is known as Euler-Lagrange equation. Any function \(y\) satisfied this equation will be a stationary path of functional \(S\).</p><h3 id=alternative-forms-of-the-euler-lagrange-equation>Alternative forms of the Euler-Lagrange equation<a hidden class=anchor aria-hidden=true href=#alternative-forms-of-the-euler-lagrange-equation>#</a></h3><h4 id=special-case-where-f-does-not-explicitly-depend-on-y-fx-doty>Special case where \(F\) does not explicitly depend on \(y\) \(F(x, \dot{y})\)<a hidden class=anchor aria-hidden=true href=#special-case-where-f-does-not-explicitly-depend-on-y-fx-doty>#</a></h4><p>Because \(F\) does not explicity dependence on \(y\), we have \(\partial F/\partial y =0\). By equation 12, it immediately follows:</p><p>$$
\begin{equation}
\begin{aligned}
& \frac{d}{dx}(\frac{\partial F}{\partial \dot{y}}) = 0 \\
\iff & \frac{\partial F}{\partial \dot{y}} = \text{constant}
\end{aligned}
\end{equation}
$$</p><h4 id=first-integral-of-euler-lagrange-equation-fy-doty>First integral of Euler-Lagrange equation \(F(y, \dot{y})\)<a hidden class=anchor aria-hidden=true href=#first-integral-of-euler-lagrange-equation-fy-doty>#</a></h4><p>Consider the total derivative of \(F\) with respect to \(x\):</p><p>$$
\begin{equation}
\begin{aligned}
\frac{dF}{dx} & =
\underbrace{\frac{\partial F}{\partial x}}_{=0}
+ \frac{\partial F}{\partial y}\frac{dy}{dx}
+ \frac{\partial F}{\partial \dot{y}}\frac{d \dot{y}}{dx} & (F \text{ does not depend on }x) \\
& = \frac{d}{dx}\big(\frac{\partial F}{\partial \dot{y}}\big)\dot{y} + \frac{\partial F}{\partial \dot{y}}\ddot{y}
& \text{(Equation 12)}\\
& = \frac{d}{dx}\big(\dot{y}\frac{\partial F}{\partial\dot{y}}\big) & u\dot{v} + v\dot{u} = \dot{(uv)} \\
\implies &
\dot{y}\frac{\partial F}{\partial\dot{y}} - F = \text{constant}
\end{aligned}
\end{equation}
$$</p><p>This equation is called the first integral of Euler-Lagrange equation.</p><h2 id=applying-euler-lagrange-equation-to-the-motivating-examples>Applying Euler-Lagrange equation to the motivating examples<a hidden class=anchor aria-hidden=true href=#applying-euler-lagrange-equation-to-the-motivating-examples>#</a></h2><h3 id=shortest-path-between-two-point-on-a-plane>Shortest path between two point on a plane<a hidden class=anchor aria-hidden=true href=#shortest-path-between-two-point-on-a-plane>#</a></h3><p>Reiterate that the path length of curve \(y(x)\) is a functional \(S\) of \(y\):</p><p>$$
\begin{equation}
\begin{aligned}
& S[y] = \int_{P_A}^{P_B}{dS} = \int_a^b{\sqrt{1 + (\dot{y})^2}dx} =: \int_a^b{F(\dot{y})dx};\\
& y(a)=A, y(b) = B
\end{aligned}
\end{equation}
$$</p><p>From equation 15, we have</p><p>$$
\begin{equation}
\begin{aligned}
& \frac{\partial F}{\partial \dot{y}} = \text{constant} \\
\iff &
\frac{\partial}{\partial \dot{y}}\sqrt{1 + (\dot{y})^2} = \text{constant} \\
\iff &
\frac{\dot{y}}{\sqrt{1 + (\dot{y})^2}} = \text{constant} \\
\iff &
\dot{y} = \text{constant} \\
\implies &
y = ax + b
\end{aligned}
\end{equation}
$$</p><p>So the shortest path between two points on a plane is a line.</p><h3 id=brachistochrone-problem>Brachistochrone problem<a hidden class=anchor aria-hidden=true href=#brachistochrone-problem>#</a></h3><p>Time functional \(T\) of curve \(y(x)\):</p><p>$$
\begin{equation}
\begin{aligned}
T[y] = \int_0^b{\sqrt{\frac{1+(\dot{y})^2}{2gy}}dx} =: \int_0^b{F(y,\dot{y}) dx}
\end{aligned}
\end{equation}
$$</p><p>Using the first integral of the Euler-Lagrange equation, we have</p><p>\begin{equation}
\begin{aligned}
& \dot{y}\frac{\partial F}{\partial \dot{y}} - F = c & \text{(c is some constant)} \\
\iff &
\dot{y}\frac{\partial}{\partial{\dot{y}}}\big(
\sqrt{\frac{1 + (\dot{y})^2}{2gy}}
\big)
- \sqrt{\frac{1 + (\dot{y})^2}{2gy}} = c \\
\iff &
\frac{(\dot{y})^2}{\sqrt{2gy[1+(\dot{y})^2]}}
- \sqrt{\frac{1 + (\dot{y})^2}{2gy}} = c \\
\iff &
\frac{1}{\sqrt{y[1+(\dot{y})^2]}} = k & \text{(for some constant k)} \\
\implies &
\dot{y} = \sqrt{\frac{h^2}{y} - 1} = \sqrt{\frac{h^2 - y}{y}} & (\text{for constant } h^2=1/k^2 > 0) \\
\implies &
dx = \sqrt{\frac{y}{h^2 - y}}dy
\end{aligned}
\end{equation}</p><p>Let \(y = h^2 \sin^2\theta\), so \(dy = 2h^2\sin\theta\cos\theta d\theta\). Subsititutes this into equation 18, we have</p><p>$$
\begin{equation}
\begin{aligned}
dx & = \sqrt{\frac{h^2 \sin^2\theta}{h^2(1 - \sin^2\theta)}}2h^2\sin\theta\cos\theta d\theta \\
& = 2h^2 \sin^2\theta d\theta
\end{aligned}
\end{equation}
$$</p><p>Take the antiderivative for both sides, we have</p><p>$$
x = \frac{h^2}{2}(2\theta - \sin 2\theta) + c
$$</p><p>Finally, we have \(x = \frac{h^2}{2}(2\theta - \sin 2\theta) + c\) and \(y = h^2\sin^2\theta\), for some \(h, c\) determined by \(y(0) = 0, y(b) = 1\). In the tutorial, \(h\) and \( c\) can only be determined numerically.</p><h2 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h2><ol><li><a href="https://www.open.edu/openlearn/8b/91/8b919cebaa524d141308761405438be36126c07d?response-content-disposition=inline%3Bfilename%3D%22Introduction%20to%20the%20calculus%20of%20variations_ms327.pdf%22&amp;response-content-type=application%2Fpdf&amp;Expires=1727281020&amp;Signature=Y5qPgt8T-FL6MrViTgisHOaDvOZrnyRTlog5CKdcx3O3IaYDepGQ43r2ZdUf2rX3tGPulZYzYbf1H1RhB6Xv2V80TZtQThFlBZLMgHWWNDR3AZKxqL8FD3Xq2vlRwft~grD5fGpioT6G57~zDUKl0TQ7bR3PDv4DzUakrkhDg-NWehqo4dIk7v5PnyFEeki7qsvbz6Dtkqo9MwEn8Z-CDWg2IUwZ5ocNFSts7Hj8ABQpljFITa8C36XvZBgy8lcmPCAhAr4gFi26Y5PXnytW7~3FCqnlLJd6pA7yK-t9A5UMW7dooi6el4bvbuMVrbrZ~sLTNXeM9SXOryke07jTBw__&amp;Key-Pair-Id=K87HJKWMK329B">Introduction to Calculus of Vartiations - Open University</a></li><li><a href="https://www.youtube.com/watch?v=k6s2G5MZv-I&amp;t=556s">Adjoint State Method for an ODE</a></li><li><a href=https://arxiv.org/abs/1806.07366>Original NeuralODE paper</a></li></ol></div><div id=disqus_thread></div><script>(function(){var e=document,t=e.createElement("script");t.src="https://iamtu-dev.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/learn/>Learn</a></li><li><a href=http://localhost:1313/tags/fdm/>Fdm</a></li><li><a href=http://localhost:1313/tags/ml/>Ml</a></li><li><a href=http://localhost:1313/tags/pde/>Pde</a></li><li><a href=http://localhost:1313/tags/pinn/>Pinn</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/ode_solver/><span class=title>« Prev</span><br><span>Numerical Integrations</span>
</a><a class=next href=http://localhost:1313/posts/heat/><span class=title>Next »</span><br><span>Learning to solve heat equation</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>iamtu</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>